function [ACC]=tempord1_runsimu_RY(vtemp,vord,vinter,vnoise,n)
%%Simulates data and crossvalidates n times


% fprintf(['Runs simulation with: VTEMP=',num2str(vtemp),'  VORD=',num2str(vord),...
%     '  VINTER=',num2str(vinter),'  VNOISE=',num2str(vnoise),...
%     '  ITERATIONS=',num2str(n),'...\n']);  
D=[];

for i=1:n
    [X,Y,YtempMean,YcombiCorrected4Temp]=tempord1_makedata_RY('vtemp',vtemp,'vord',vord,'vinter',vinter,'vnoise',vnoise);
    [zAcc_ovrall, zAcc_ord, zAcc_temp, zAcc_int]=tempord1_classify_RY(X,Y,YtempMean,YcombiCorrected4Temp);
    
    %********* for dimensionality analysis:
    D.ACC(i,:)=acc_inter;
    %*********
    
    D.ACC(i,1)=acc_temp; D.var(i,1)=1;
    D.ACC(i+n,1)=acc_ord; D.var(i+n,1)=2;
    D.ACC(i+n*2,1)=acc_inter; D.var(i+n*2,1)=3;    
    D.ACC(i+n*3,1)=acc_tempMean; D.var(i+n*3,1)=4;
    D.ACC(i+n*4,1)=acc_tempOneOut; D.var(i+n*4,1)=5;
    
    D.ACC(i+n*5,1)=acc_tempClass; D.var(i+n*5,1)=6;
    D.ACC(i+n*6,1)=acc_ordClass; D.var(i+n*6,1)=7;
    
    D.ACC(i+n*7,1)=acc_interCorrected4Temp; D.var(i+n*7,1)=8;
    D.ACC(i+n*8,1)=zacc_ordOneOut; D.var(i+n*8,1)=9;
    

end

%%Display figure with barplot
% figure;
barplot(D.var,D.ACC,'split',D.var,'style_bold','leg',{'temp' ,'ord','inter','tempMean'},'leglocation','north');
title(['# of iterations=',num2str(n),'  TEMP=',num2str(vtemp),'  ORD=',num2str(vord),'  INTER=',num2str(vinter),'  NOISE=',num2str(vnoise)]);
%axis([0 7 0 1.2]);   
ylabel('acc');
xlabel('factor');

ACC=D.ACC;

